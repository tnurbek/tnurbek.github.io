<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> | Nurbek Tastan </title> <meta name="author" content="Nurbek Tastan"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon2.png?9c52615f1b2075b2371a759a539f2a9f"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tnurbek.github.io/shapfed/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Nurbek</span> Tastan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title"></h1> <p class="post-description"></p> </header> <article> <div style="text-align: center; margin-bottom: 15px"> <h2 style="font-weight: bold;">Redefining Contributions: Shapley-Driven Federated Learning</h2> <h4> <strong style="margin-right: 80px;"><a href="https://tnurbek.github.io/" target="_blank" rel="noopener noreferrer">Nurbek Tastan</a></strong> <strong style="margin-right: 80px;"><a href="https://www.linkedin.com/in/samarfares/" rel="noopener noreferrer" target="_blank">Samar Fares</a></strong> <strong><a href="https://www.toluwaniaremu.com/" target="_blank" rel="noopener noreferrer">Toluwani Aremu</a></strong> </h4> <h4> <strong style="margin-right: 80px;"><a href="https://samuelhorvath.github.io/" target="_blank" rel="noopener noreferrer">Samuel Horvath</a></strong> <strong><a href="https://www.sprintai.org/nkarthik" target="_blank" rel="noopener noreferrer">Karthik Nandakumar</a></strong> </h4> <div style="display: flex; justify-content: center; align-items: center; gap: 40px;"> <div style="text-align: center; position: relative; max-width: 80%; margin-top: 20px;"> <sup style="padding-right: 3px; font-size: 20px; font-weight: normal;">Mohamed bin Zayed University of Artificial Intelligence (MBZUAI)</sup> </div> </div> </div> <div class="row"> <div class="col-sm-12"> <div class="b-container" style="text-align: center; margin-bottom: 20px;"> <a href="" target="_blank" rel="noopener noreferrer" class="btn" style="font-size: 1.1rem; text-transform: lowercase; border-radius: 1.05rem; padding: .7rem 2.14rem;"> <i class="fa-solid fa-file-pdf"></i> Paper </a> <a href="" target="_blank" rel="noopener noreferrer" class="btn" style="font-size: 1.1rem; text-transform: lowercase; border-radius: 1.05rem; padding: .7rem 2.14rem;"> <i class="fa-solid fa-code"></i> Code </a> <a href="" target="_blank" rel="noopener noreferrer" class="btn" style="font-size: 1.1rem; text-transform: lowercase; border-radius: 1.05rem; padding: .7rem 2.14rem;"> <i class="fa-brands fa-youtube"></i> Video </a> <a href="" target="_blank" rel="noopener noreferrer" class="btn" style="font-size: 1.1rem; text-transform: lowercase; border-radius: 1.05rem; padding: .7rem 2.14rem;"> <i class="fa-solid fa-file-powerpoint"></i> Slides </a> </div> </div> </div> <div class="row justify-content-between" style="margin-top: 75px;"> <div class="col-sm-9 mx-auto"> <h3 class="text-center" style="font-weight: bold;"><b>Abstract</b></h3> <p style="text-align: justify;"> Federated learning (FL) has emerged as a pivotal approach in machine learning, enabling multiple participants to collaboratively train a global model without sharing raw data. While FL finds applications in various domains such as healthcare and finance, it is challenging to ensure global model convergence when participants do not contribute equally and/or honestly. To overcome this challenge, principled mechanisms are required to evaluate the contributions made by individual participants in the FL setting. Existing solutions for contribution assessment rely on general accuracy evaluation, often failing to capture nuanced dynamics and class-specific influences. This paper proposes a novel contribution assessment method called ShapFed for fine-grained evaluation of participant contributions in FL. Our approach uses Shapley values from cooperative game theory to provide a granular understanding of class-specific influences. Based on ShapFed, we introduce a weighted aggregation method called ShapFed-WA, which outperforms conventional federated averaging, especially in class-imbalanced scenarios. Personalizing participant updates based on their contributions further enhances collaborative fairness by delivering differentiated models commensurate with the participant contributions. Experiments on CIFAR-10, Chest X-Ray, and Fed-ISIC2019 datasets demonstrate the effectiveness of our approach in improving utility, efficiency, and fairness in FL systems. </p> </div> </div> <hr> <div class="row"> <div class="col-sm-12 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed-480.webp 480w,/assets/img/shapfed-800.webp 800w,/assets/img/shapfed-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed.png" class="img-fluid z-depth-1" width="100%" height="auto" title="ShapFed Algorithm" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption text-left" style="text-align: justify;"> <b>Overview of our proposed ShapFed algorithm:</b> Each participant \(i\) transmits their locally computed iterates \(w_i\) to the server. The server then, (i) computes class-specific Shapley values (CSSVs) using the last layer parameters (gradients) \(\hat{w}\) (as illustrated in Figure \ref{fig: network-illustration}), (ii) aggregates the weights by employing normalized contribution assessment values \(\tilde{\gamma}_i\) for each participant \(i\), and (iii) broadcasts the personalized weights \(\bar{w}_i\) to each participant, using their individual, not-normalized contribution values \(\gamma_i\). </div> <hr> <h4 id="shapfed---main-algorithm"><strong>ShapFed - Main Algorithm</strong></h4> <div class="row justify-content-between"> <div class="col-sm-5 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/pseudo-code-480.webp 480w,/assets/img/shapfed/pseudo-code-800.webp 800w,/assets/img/shapfed/pseudo-code-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/pseudo-code.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-7"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/alignment-480.webp 480w,/assets/img/shapfed/alignment-800.webp 800w,/assets/img/shapfed/alignment-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/alignment.jpg" class="img-fluid z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption text-left"> <b>Weighted Aggregation:</b> The optimal weights \(w_s^{\star}\) are derived using Equation 7, while <span style="color: red;">\(w_s\)</span> represents the result of applying equal weights (FedAvg). <b>Personalization:</b> Rather than distributing a uniform global model to all users, we provide personalized weights \(\bar{w}_i\), which are \(\gamma_i\) combinations of individual user weights \(w_i\) and the optimally aggregated weight \(w_s^{\star}\). </div> </div> </div> <hr> <h4 id="results-contribution-assessment"><strong>Results: Contribution Assessment</strong></h4> <div class="row justify-content-between"> <div class="col-sm-5 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/contribution-comparison-480.webp 480w,/assets/img/shapfed/contribution-comparison-800.webp 800w,/assets/img/shapfed/contribution-comparison-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/contribution-comparison.jpg" class="img-fluid z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption text-left"> Comparison of our proposed contribution assessment algorithm (CSSV) with CGSV and true Shapley value computations using ResNet-34 architecture on Chest X-Ray dataset. </div> </div> <div class="col-sm-7"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/cifar10-skew-480.webp 480w,/assets/img/shapfed/cifar10-skew-800.webp 800w,/assets/img/shapfed/cifar10-skew-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/cifar10-skew.jpg" class="img-fluid z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption text-left"> Heatmap visualization of class-specific Shapley values for heterogeneous setting (explained in Section 5.2) evaluated on CIFAR-10 dataset. </div> </div> </div> <hr> <h4 id="results-weighted-aggregation"><strong>Results: Weighted Aggregation</strong></h4> <div class="row justify-content-between"> <div class="col-sm-9 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/imbalanced_cifar-480.webp 480w,/assets/img/shapfed/imbalanced_cifar-800.webp 800w,/assets/img/shapfed/imbalanced_cifar-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/imbalanced_cifar.jpg" class="img-fluid z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption text-left"> Comparing FedAvg and ShapFed-WA on CIFAR10 under an imbalanced split scenario: insights into the balanced accuracy of four individual participants. </div> </div> </div> <div class="row justify-content-between"> <div class="col-sm-8 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/shapfed/fedisic-plot-480.webp 480w,/assets/img/shapfed/fedisic-plot-800.webp 800w,/assets/img/shapfed/fedisic-plot-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/shapfed/fedisic-plot.jpg" class="img-fluid z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption text-left"> <b>(Left)</b> The balanced accuracy of our methods (ShapFed-WA &amp; ShapFed) vs FedAvg. <b>(Right)</b> Per-participant accuracy using all methods evaluated on Fed-ISIC2019 dataset. </div> </div> </div> <hr> <h4 id="results-personalization"><strong>Results: Personalization</strong></h4> <table style="width: 100%; border-collapse: collapse; margin-top: 20px;" border="1" class="text-center"> <caption>Performance and fairness comparison with our method and FedAvg. We use Pearson's correlation (↑) as a fairness metric on CIFAR-10. The red highlight indicates a negative gain from collaboration.</caption> <thead> <tr style="background-color: lightblue;"> <th colspan="2">Dataset / Partition</th> <th>Setting</th> <th>\(P_1\)</th> <th>\(P_2\)</th> <th>\(P_3\)</th> <th>\(P_4\)</th> <th>\(P_5\)</th> <th>Corr.</th> </tr> </thead> <tbody> <tr> <td rowspan="3">ChestXRay</td> <td rowspan="3">Hetero.</td> <td>Individual</td> <td>50.0</td> <td>64.7</td> <td>62.0</td> <td>53.7</td> <td>50.0</td> <td>---</td> </tr> <tr> <td>FedAvg</td> <td>50.0</td> <td>55.8</td> <td>61.9</td> <td>54.2</td> <td>50.0</td> <td>0.82</td> </tr> <tr style="background-color: lightgreen;"> <td>ShapFed</td> <td>50.0</td> <td>65.2</td> <td>69.5</td> <td>58.5</td> <td>50.0</td> <td><strong>0.93</strong></td> </tr> <tr> <td rowspan="8">CIFAR-10</td> <td rowspan="4">Imb.</td> <td>Individual</td> <td>75.8</td> <td>45.4</td> <td>48.6</td> <td>31.6</td> <td>---</td> <td>---</td> </tr> <tr> <td>FedAvg</td> <td style="background-color: lightcoral;">56.6</td> <td>56.8</td> <td>63.8</td> <td>64.2</td> <td>---</td> <td>-0.60</td> </tr> <tr> <td>CGSV</td> <td style="background-color: lightcoral;">57.2</td> <td>59.0</td> <td>58.8</td> <td>60.4</td> <td>---</td> <td>-0.98</td> </tr> <tr style="background-color: lightgreen;"> <td>ShapFed</td> <td>81.4</td> <td>78.2</td> <td>71.8</td> <td>73.6</td> <td>---</td> <td><strong>0.74</strong></td> </tr> <tr> <td rowspan="4">Hetero.</td> <td>Individual</td> <td>75.2</td> <td>68.8</td> <td>66.8</td> <td>69.0</td> <td>---</td> <td>---</td> </tr> <tr> <td>FedAvg</td> <td style="background-color: lightcoral;">74.6</td> <td>70.2</td> <td>70.2</td> <td>76.0</td> <td>---</td> <td>0.53</td> </tr> <tr> <td>CGSV</td> <td style="background-color: lightcoral;">55.0</td> <td style="background-color: lightcoral;">55.8</td> <td style="background-color: lightcoral;">57.2</td> <td style="background-color: lightcoral;">52.6</td> <td>---</td> <td>-0.26</td> </tr> <tr style="background-color: lightgreen;"> <td>ShapFed</td> <td>79.8</td> <td>75.4</td> <td>69.0</td> <td>75.0</td> <td>---</td> <td><strong>0.90</strong></td> </tr> </tbody> <tfoot> <tr> <td colspan="9">Note: Correlation coefficients indicate the fairness level, with higher values showing better fairness.</td> </tr> </tfoot> </table> <table style="width: 87.5%; margin: auto; border-collapse: collapse; border: 1px solid black;" border="1" class="text-center"> <caption style="margin-bottom: 8px;">Performance and fairness comparison using Pearson's correlation (↑) as a fairness metric on Fed-ISIC2019. The red highlight indicates a negative gain from collaboration.</caption> <thead> <tr style="background-color: lightblue;"> <th>Setting</th> <th>\(P_1\)</th> <th>\(P_2\)</th> <th>\(P_3\)</th> <th>\(P_4\)</th> <th>\(P_5\)</th> <th>\(P_6\)</th> <th>Corr.</th> </tr> </thead> <tbody> <tr> <td>Individual</td> <td>67.2</td> <td>25.7</td> <td>42.3</td> <td>31.0</td> <td>18.5</td> <td>15.6</td> <td>---</td> </tr> <tr> <td>FedAvg</td> <td style="background-color: lightcoral;">65.4</td> <td>40.9</td> <td>57.2</td> <td>59.3</td> <td>51.5</td> <td>56.2</td> <td>0.63</td> </tr> <tr style="background-color: lightgreen;"> <td>ShapFed-WA</td> <td>69.3</td> <td>44.3</td> <td>65.0</td> <td>63.1</td> <td>54.8</td> <td>61.2</td> <td>0.62</td> </tr> <tr style="background-color: lightgreen;"> <td>ShapFed</td> <td>68.5</td> <td>44.4</td> <td>61.9</td> <td>60.4</td> <td>40.6</td> <td>53.2</td> <td><strong>0.84</strong></td> </tr> </tbody> </table> <hr> <h4 id="summary"><strong>Summary</strong></h4> <p align="justify">This work proposes Class-Specific Shapley Values (CSSVs) to quantify participant contributions at a granular level. The contributions of this work include a novel method to deepen the understanding of participant impact and improve fairness analysis. Evaluation against FedAvg shows superior performance and additional experiments reveal enhanced fairness by personalizing client updates based on contributions. Overall, the approach aims to achieve a more equitable distribution of benefits in FL. In future, we plan to conduct an in-depth theoretical analysis aimed at identifying the specific characteristics that contribute to an effective estimation of Shapley values. This analysis will enhance our understanding of the factors that influence the accuracy and reliability of Shapley value approximations. Furthermore, an investigation into what makes our approximation of cosine similarity from the last layer a robust indicator of contributions will be explored.</p> <h4 id="contact"><strong>Contact</strong></h4> <p> Contact me at <a href="mailto:nurbek.tastan@mbzuai.ac.ae">nurbek [dot] tastan [at] mbzuai [dot] ac [dot] ae</a>. </p> <h4 id="citation"><strong>Citation</strong></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@InProceedings{tastan2024redefining,
    author    = {Tastan, Nurbek and Fares, Samar and Aremu, Toluwani and Horvath, Samuel and Nandakumar, Karthik},
    title     = {Redefining Contributions: Shapley-Driven Federated Learning}, 
    booktitle = {International Joint Conference on Artificial Intelligence (IJCAI)},
    year      = {2024},
}
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Nurbek Tastan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>